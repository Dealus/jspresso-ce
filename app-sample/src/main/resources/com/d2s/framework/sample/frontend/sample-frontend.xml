<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<!--
  Test view description context.
-->
<beans>
  <!-- 
    Actions
  -->
  <bean id="nameToUppercaseCollectionBackAction" parent="scriptedBackAction"
    class="com.d2s.framework.application.backend.action.ScriptedBackendAction">
    <property name="scriptLanguage" value="jython" />
    <property name="script">
      <value>
        <![CDATA[
from java.util import HashMap

result = HashMap()
script = bsf.lookupBean("SCRIPT")
scriptedAction = bsf.lookupBean("SCRIPTED_OBJECT")
collectionConnector = scriptedAction.getModelConnector()
for selectedIndex in scriptedAction.getContext().get("SELECTED_INDICES"):
  collectionConnector.getChildConnector(selectedIndex).getConnectorValue().transformNameToUppercase()
script.setExecutionResult(result)
				]]>
      </value>
    </property>
  </bean>

  <bean id="nameToUppercaseCollectionFrontAction" class="com.d2s.framework.application.frontend.action.ActionWrapper">
    <property name="iconImageURL" value="classpath:images/utilities-48x48.png" />
    <property name="name" value="doService" />
    <property name="description" value="Execute service on selected details" />
    <property name="wrappedAction" ref="nameToUppercaseCollectionBackAction" />
  </bean>

  <bean id="personMasterDetailActionMap" class="com.d2s.framework.view.action.ActionMap">
    <property name="parentActionMaps">
      <list>
        <ref bean="masterDetailActionMap" />
      </list>
    </property>
    <property name="actionMap">
      <map>
        <entry key="SERVICE">
          <list>
            <ref local="nameToUppercaseCollectionFrontAction" />
          </list>
        </entry>
      </map>
    </property>
  </bean>

  <bean id="department.pane" parent="decoratedView"
    class="com.d2s.framework.view.descriptor.basic.BasicComponentViewDescriptor">
    <property name="name" value="department" />
    <property name="description" value="departmentView" />
    <property name="labelsPosition" ref="ABOVE" />
    <property name="columnCount" value="3" />
    <property name="modelDescriptor" ref="com.d2s.framework.sample.backend.domain.Department" />
    <property name="renderedProperties">
      <list>
        <value>id</value>
        <value>name</value>
        <value>version</value>
        <value>createTimestamp</value>
        <value>lastUpdateTimestamp</value>
        <value>manager</value>
        <value>description</value>
        <value>departmentEmployees</value>
      </list>
    </property>
    <property name="propertyWidths">
      <map>
        <entry key="description">
          <value type="java.lang.Integer">2</value>
        </entry>
      </map>
    </property>
    <property name="renderedChildProperties">
      <map>
        <entry key="departmentEmployees">
          <list>
            <value>name</value>
          </list>
        </entry>
      </map>
    </property>
  </bean>

  <bean id="employee.pane" parent="decoratedView"
    class="com.d2s.framework.view.descriptor.basic.BasicComponentViewDescriptor">
    <property name="name" value="employee" />
    <property name="description" value="employeeView" />
    <property name="labelsPosition" ref="ABOVE" />
    <property name="columnCount" value="3" />
    <property name="modelDescriptor" ref="com.d2s.framework.sample.backend.domain.Employee" />
    <property name="renderedProperties">
      <list>
        <value>id</value>
        <value>name</value>
        <value>birthDate</value>
        <value>age</value>
        <value>birthCity</value>
        <value>addressCity</value>
      </list>
    </property>
  </bean>

  <bean id="project.pane" parent="decoratedView"
    class="com.d2s.framework.view.descriptor.basic.BasicComponentViewDescriptor">
    <property name="name" value="project" />
    <property name="description" value="projectView" />
    <property name="labelsPosition" ref="ABOVE" />
    <property name="columnCount" value="3" />
    <property name="modelDescriptor" ref="com.d2s.framework.sample.backend.domain.Project" />
    <property name="renderedProperties">
      <list>
        <value>id</value>
        <value>name</value>
        <value>department</value>
      </list>
    </property>
  </bean>

  <bean id="department.departmentEmployees.table" parent="decoratedView"
    class="com.d2s.framework.view.descriptor.basic.BasicTableViewDescriptor">
    <property name="name" value="departmentEmployees.table" />
    <property name="iconImageURL" value="classpath:images/icon2-48x48.png" />
    <property name="description" value="departmentEmployeesView" />
    <property name="modelDescriptor" ref="Department-departmentEmployees-descriptor" />
    <property name="actionMap" ref="personMasterDetailActionMap" />
  </bean>

  <bean id="employee.managedEmployees.table" parent="decoratedView"
    class="com.d2s.framework.view.descriptor.basic.BasicTableViewDescriptor">
    <property name="name" value="managedEmployees.table" />
    <property name="iconImageURL" value="classpath:images/icon3-48x48.png" />
    <property name="description" value="managedEmployeesView" />
    <property name="modelDescriptor" ref="Employee-managedEmployees-descriptor" />
    <property name="actionMap" ref="masterDetailActionMap" />
  </bean>

  <bean id="department.departmentProjects.table" parent="decoratedView"
    class="com.d2s.framework.view.descriptor.basic.BasicTableViewDescriptor">
    <property name="name" value="departmentProjects.table" />
    <property name="iconImageURL" value="classpath:images/icon4-48x48.png" />
    <property name="description" value="departmentProjectsView" />
    <property name="modelDescriptor" ref="Department-projects-descriptor" />
    <property name="actionMap" ref="masterDetailActionMap" />
  </bean>

  <bean id="project.projectMembers.table" parent="decoratedView"
    class="com.d2s.framework.view.descriptor.basic.BasicTableViewDescriptor">
    <property name="name" value="projectMembers.table" />
    <property name="iconImageURL" value="classpath:images/icon3-48x48.png" />
    <property name="description" value="projectMembersView" />
    <property name="modelDescriptor" ref="Project-projectMembers-descriptor" />
    <property name="actionMap" ref="personMasterDetailActionMap" />
  </bean>

  <bean id="departments.list" class="com.d2s.framework.view.descriptor.basic.BasicListViewDescriptor">
    <property name="name" value="departments.list" />
    <property name="iconImageURL" value="classpath:images/icon1-48x48.png" />
    <property name="description" value="departmentsView" />
    <property name="renderedProperty" value="name" />
  </bean>

  <bean id="department.departmentEmployees.list"
    class="com.d2s.framework.view.descriptor.basic.BasicListViewDescriptor">
    <property name="name" value="departmentEmployees.list" />
    <property name="iconImageURL" value="classpath:images/icon2-48x48.png" />
    <property name="description" value="departmentEmployeesView" />
    <property name="modelDescriptor" ref="Department-departmentEmployees-descriptor" />
    <property name="renderedProperty" value="name" />
    <property name="actionMap" ref="personMasterDetailActionMap" />
  </bean>

  <bean id="department.departmentProjects.list"
    class="com.d2s.framework.view.descriptor.basic.BasicListViewDescriptor">
    <property name="name" value="departmentProjects.list" />
    <property name="iconImageURL" value="classpath:images/icon4-48x48.png" />
    <property name="description" value="departmentProjectsView" />
    <property name="modelDescriptor" ref="Department-projects-descriptor" />
    <property name="renderedProperty" value="name" />
    <property name="actionMap" ref="masterDetailActionMap" />
  </bean>

  <bean id="employee.managedEmployees.list" class="com.d2s.framework.view.descriptor.basic.BasicListViewDescriptor">
    <property name="name" value="managedEmployees.list" />
    <property name="iconImageURL" value="classpath:images/icon3-48x48.png" />
    <property name="description" value="managedEmployeesView" />
    <property name="modelDescriptor" ref="Employee-managedEmployees-descriptor" />
    <property name="renderedProperty" value="name" />
    <property name="actionMap" ref="masterDetailActionMap" />
  </bean>

  <bean id="project.projectMembers.list" class="com.d2s.framework.view.descriptor.basic.BasicListViewDescriptor">
    <property name="name" value="projectMembers.list" />
    <property name="iconImageURL" value="classpath:images/icon3-48x48.png" />
    <property name="description" value="projectMembersView" />
    <property name="modelDescriptor" ref="Project-projectMembers-descriptor" />
    <property name="renderedProperty" value="name" />
    <property name="actionMap" ref="masterDetailActionMap" />
  </bean>

  <bean id="employee.managedEmployees.pane"
    class="com.d2s.framework.view.descriptor.basic.BasicEvenGridViewDescriptor">
    <property name="name" value="employee" />
    <property name="iconImageURL" value="classpath:images/icon2-48x48.png" />
    <property name="drivingDimension" ref="ROW" />
    <property name="drivingDimensionCellCount" value="1" />
    <property name="masterDetail" value="true" />
    <property name="viewDescriptors">
      <list>
        <ref local="employee.pane" />
        <ref local="employee.managedEmployees.table" />
      </list>
    </property>
  </bean>

  <bean id="employee.managedEmployees.tree.pane"
    class="com.d2s.framework.view.descriptor.basic.BasicSplitViewDescriptor">
    <property name="name" value="employee" />
    <property name="iconImageURL" value="classpath:images/icon2-48x48.png" />
    <property name="masterDetail" value="true" />
    <property name="orientation" ref="HORIZONTAL" />
    <property name="leftTopViewDescriptor" ref="employee.tree" />
    <property name="rightBottomViewDescriptor" ref="employee.managedEmployees.pane" />
  </bean>

  <bean id="project.projectMembers.tree.pane"
    class="com.d2s.framework.view.descriptor.basic.BasicSplitViewDescriptor">
    <property name="name" value="project" />
    <property name="iconImageURL" value="classpath:images/icon4-48x48.png" />
    <property name="masterDetail" value="true" />
    <property name="orientation" ref="HORIZONTAL" />
    <property name="leftTopViewDescriptor" ref="project.tree" />
    <property name="rightBottomViewDescriptor" ref="project.multi.pane" />
  </bean>

  <bean id="project.projectMembers.pane" class="com.d2s.framework.view.descriptor.basic.BasicEvenGridViewDescriptor">
    <property name="name" value="project" />
    <property name="iconImageURL" value="classpath:images/icon4-48x48.png" />
    <property name="drivingDimension" ref="ROW" />
    <property name="drivingDimensionCellCount" value="1" />
    <property name="masterDetail" value="true" />
    <property name="viewDescriptors">
      <list>
        <ref local="project.pane" />
        <ref local="project.projectMembers.table" />
      </list>
    </property>
  </bean>

  <bean id="project.multi.pane" class="com.d2s.framework.view.descriptor.basic.BasicCardViewDescriptor">
    <property name="name" value="projectPane" />
    <property name="masterDetail" value="false" />
    <property name="viewDescriptors">
      <map>
        <entry key="E" value-ref="employee.managedEmployees.pane" />
        <entry key="P" value-ref="project.projectMembers.pane" />
      </map>
    </property>
    <property name="classNameToCardMapping">
      <map>
        <entry key="com.d2s.framework.sample.backend.domain.Employee" value="E" />
        <entry key="com.d2s.framework.sample.backend.domain.Project" value="P" />
      </map>
    </property>
  </bean>

  <bean id="department.employees.pane" class="com.d2s.framework.view.descriptor.basic.BasicEvenGridViewDescriptor">
    <property name="name" value="employees" />
    <property name="iconImageURL" value="classpath:images/icon2-48x48.png" />
    <property name="drivingDimension" ref="ROW" />
    <property name="drivingDimensionCellCount" value="1" />
    <property name="masterDetail" value="true" />
    <property name="viewDescriptors">
      <list>
        <ref local="department.pane" />
        <ref local="department.departmentEmployees.table" />
        <ref local="employee.managedEmployees.table" />
        <ref local="employee.managedEmployees.tree.pane" />
      </list>
    </property>
  </bean>

  <bean id="department.projects.pane" class="com.d2s.framework.view.descriptor.basic.BasicEvenGridViewDescriptor">
    <property name="name" value="projects" />
    <property name="iconImageURL" value="classpath:images/icon4-48x48.png" />
    <property name="drivingDimension" ref="ROW" />
    <property name="drivingDimensionCellCount" value="1" />
    <property name="masterDetail" value="true" />
    <property name="viewDescriptors">
      <list>
        <ref local="department.departmentProjects.table" />
        <ref local="project.projectMembers.table" />
      </list>
    </property>
  </bean>

  <bean id="department.employees.projects.pane"
    class="com.d2s.framework.view.descriptor.basic.BasicTabViewDescriptor">
    <property name="name" value="paneView" />
    <property name="masterDetail" value="false" />
    <property name="viewDescriptors">
      <list>
        <ref local="department.employees.pane" />
        <ref local="department.projects.pane" />
      </list>
    </property>
  </bean>

  <bean id="employee.managedEmployees.subtree"
    class="com.d2s.framework.view.descriptor.basic.BasicCompositeTreeLevelDescriptor">
    <property name="nodeGroupDescriptor" ref="employee.managedEmployees.list" />
    <property name="childrenDescriptors">
      <list>
        <ref local="employee.managedEmployees.subtree" />
      </list>
    </property>
  </bean>

  <bean id="department.departmentEmployees.subtree"
    class="com.d2s.framework.view.descriptor.basic.BasicCompositeTreeLevelDescriptor">
    <property name="nodeGroupDescriptor" ref="department.departmentEmployees.list" />
    <property name="childrenDescriptors">
      <list>
        <ref local="employee.managedEmployees.subtree" />
      </list>
    </property>
  </bean>

  <bean id="project.projectMembers.subtree"
    class="com.d2s.framework.view.descriptor.basic.BasicCompositeTreeLevelDescriptor">
    <property name="nodeGroupDescriptor" ref="project.projectMembers.list" />
    <property name="childrenDescriptors">
      <list>
        <ref local="employee.managedEmployees.subtree" />
      </list>
    </property>
  </bean>

  <bean id="department.departmentProjects.subtree"
    class="com.d2s.framework.view.descriptor.basic.BasicCompositeTreeLevelDescriptor">
    <property name="nodeGroupDescriptor" ref="department.departmentProjects.list" />
    <property name="childrenDescriptors">
      <list>
        <ref local="project.projectMembers.subtree" />
      </list>
    </property>
  </bean>

  <bean id="company.companyDepartments.subtree"
    class="com.d2s.framework.view.descriptor.basic.BasicCompositeTreeLevelDescriptor">
    <property name="nodeGroupDescriptor" ref="departments.list" />
    <property name="childrenDescriptors">
      <list>
        <ref local="department.departmentEmployees.subtree" />
        <ref local="department.departmentProjects.subtree" />
      </list>
    </property>
  </bean>

  <bean id="department.tree" class="com.d2s.framework.view.descriptor.basic.BasicTreeViewDescriptor">
    <property name="name" value="department.tree" />
    <property name="modelDescriptor" ref="com.d2s.framework.sample.backend.domain.Department" />
    <property name="rootSubtreeDescriptor" ref="company.companyDepartments.subtree" />
  </bean>

  <bean id="employee.tree" class="com.d2s.framework.view.descriptor.basic.BasicTreeViewDescriptor">
    <property name="name" value="employee.tree" />
    <property name="modelDescriptor" ref="com.d2s.framework.sample.backend.domain.Employee" />
    <property name="rootSubtreeDescriptor" ref="department.departmentEmployees.subtree" />
  </bean>

  <bean id="project.tree" class="com.d2s.framework.view.descriptor.basic.BasicTreeViewDescriptor">
    <property name="name" value="project.tree" />
    <property name="modelDescriptor" ref="com.d2s.framework.sample.backend.domain.Project" />
    <property name="rootSubtreeDescriptor" ref="department.departmentProjects.subtree" />
  </bean>

  <bean id="department.multi.pane" class="com.d2s.framework.view.descriptor.basic.BasicCardViewDescriptor">
    <property name="name" value="departmentPane" />
    <property name="masterDetail" value="false" />
    <property name="viewDescriptors">
      <map>
        <entry key="EP" value-ref="department.employees.projects.pane" />
        <entry key="E" value-ref="employee.managedEmployees.tree.pane" />
        <entry key="P" value-ref="project.projectMembers.tree.pane" />
      </map>
    </property>
    <property name="classNameToCardMapping">
      <map>
        <entry key="com.d2s.framework.sample.backend.domain.Department" value="EP" />
        <entry key="com.d2s.framework.sample.backend.domain.Employee" value="E" />
        <entry key="com.d2s.framework.sample.backend.domain.Project" value="P" />
      </map>
    </property>
  </bean>

  <bean id="department.view" class="com.d2s.framework.view.descriptor.basic.BasicSplitViewDescriptor"
    parent="decoratedView">
    <property name="name" value="departmentRootView" />
    <property name="masterDetail" value="true" />
    <property name="orientation" ref="HORIZONTAL" />
    <property name="leftTopViewDescriptor" ref="department.tree" />
    <property name="rightBottomViewDescriptor" ref="department.multi.pane" />
    <property name="iconImageURL" value="classpath:images/icon1-48x48.png" />
    <property name="modelDescriptor" ref="com.d2s.framework.sample.backend.domain.Department" />
    <property name="actionMap" ref="projectedActionMap" />
  </bean>


  <!--
    The projection models.
  -->

  <bean id="departments.projected" class="com.d2s.framework.model.descriptor.basic.BasicCollectionDescriptor">
    <property name="name" value="projectedObjects" />
    <property name="collectionInterface" value="java.util.List" />
    <property name="elementDescriptor" ref="com.d2s.framework.sample.backend.domain.Department" />
  </bean>

  <bean id="departments.projection" class="com.d2s.framework.view.projection.BeanProjection">
    <property name="name" value="departments.projection" />
    <property name="description" value="Departments" />
    <property name="viewDescriptor" ref="company.departments.projection.view" />
  </bean>

  <bean id="company.projection" class="com.d2s.framework.view.projection.Projection">
    <property name="name" value="company.projection" />
    <property name="description" value="Company" />
    <property name="children">
      <list>
        <ref local="departments.projection" />
      </list>
    </property>
  </bean>


  <!--
    The projected views.
  -->

  <bean id="departments.projected.table" class="com.d2s.framework.view.descriptor.basic.BasicTableViewDescriptor">
    <property name="name" value="company.departments" />
    <property name="iconImageURL" value="classpath:images/browser-48x48.png" />
    <property name="modelDescriptor" ref="departments.projected" />
    <property name="actionMap" ref="projectedCollectionActionMap" />
  </bean>

  <!--
    The projection views.
  -->

  <bean id="department.projection.view"
    class="com.d2s.framework.view.descriptor.projection.basic.BasicSimpleChildProjectionViewDescriptor">
    <property name="projectedViewDescriptor" ref="department.view" />
    <property name="nodeGroupDescriptor">
      <bean parent="abstractChildrenProjectionNodeGroupDescriptor">
        <property name="name" value="company.projection.view" />
        <property name="description" value="company.projection.view" />
        <property name="iconImageURL" value="classpath:images/3d-48x48.png" />
        <property name="actionMap" ref="projectionActionMap" />
      </bean>
    </property>
  </bean>

  <bean id="company.departments.projection.view"
    class="com.d2s.framework.view.descriptor.projection.basic.BasicSimpleChildProjectionViewDescriptor">
    <property name="name" value="company.departments.projection.view" />
    <property name="description" value="company.departments.projection.view" />
    <property name="iconImageURL" value="classpath:images/browser-48x48.png" />
    <property name="projectedViewDescriptor" ref="departments.projected.table" />
    <property name="childDescriptor" ref="department.projection.view" />
  </bean>

  <bean id="company.projection.view"
    class="com.d2s.framework.view.descriptor.projection.basic.BasicSimpleChildProjectionViewDescriptor">
    <property name="name" value="company.projection.view" />
    <property name="description" value="company.projection.view" />
    <property name="iconImageURL" value="classpath:images/demo-48x48.png" />
    <property name="childDescriptor" ref="company.departments.projection.view" />
  </bean>

  <bean id="company.projection.root"
    class="com.d2s.framework.view.descriptor.projection.basic.BasicProjectionViewDescriptor">
    <property name="name" value="company.projection" />
    <property name="description" value="company.projection" />
    <property name="rootSubtreeDescriptor" ref="company.projection.view" />
  </bean>

  <!--
    The controllers.
  -->
  <bean id="applicationFrontController" parent="frontController">
    <property name="name" value="Test Application" />
    <property name="iconImageURL" value="classpath:images/icon1-48x48.png" />
    <property name="rootProjectionViewDescriptors">
      <map>
        <entry key="company" value-ref="company.projection.root" />
      </map>
    </property>
  </bean>
  <bean id="applicationBackController" parent="abstractBackController">
    <property name="rootProjections">
      <map>
        <entry key="company" value-ref="company.projection" />
      </map>
    </property>
  </bean>
</beans>
